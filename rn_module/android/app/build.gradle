apply plugin: "com.android.library"
apply plugin: "org.jetbrains.kotlin.android"
apply plugin: "com.facebook.react"

android {
    compileSdk rootProject.ext.compileSdkVersion
    buildToolsVersion rootProject.ext.buildToolsVersion

    namespace "com.myrnmodule"

    defaultConfig {
        minSdkVersion rootProject.ext.minSdkVersion
        targetSdkVersion rootProject.ext.targetSdkVersion
    }

    buildTypes {
        release {
            minifyEnabled false
        }
    }

    lintOptions {
        abortOnError false
    }

    // ADD THIS BLOCK:
    compileOptions {
        sourceCompatibility JavaVersion.VERSION_17
        targetCompatibility JavaVersion.VERSION_17
    }

    kotlinOptions {
        jvmTarget = '17'
    }

    // Make sure native libraries are packaged correctly
    packagingOptions {
        jniLibs {
            useLegacyPackaging = true
        }
    }

    sourceSets {
        main {
            assets.srcDirs = ['src/main/assets']
        }
    }
}

// Explicitly enable Hermes (or set to false for JSC)
project.ext.react = [
    enableHermes: true  // Change to false if you prefer JSC.
]

repositories {
    google()
    mavenCentral()
    maven { url 'https://jitpack.io' }
    // REMOVE node_modules/react-native maven
}

dependencies {
    implementation("com.facebook.react:react-android:+")
    implementation("com.facebook.react:hermes-android:+")
    implementation fileTree(dir: 'libs', include: ['*.aar'])
}

// Required for native modules
apply from: file("../../node_modules/@react-native-community/cli-platform-android/native_modules.gradle"); 
applyNativeModulesAppBuildGradle(project)
